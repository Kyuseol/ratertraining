# 엑셀 대량 업로드 가이드

**작성일:** 2025-12-17  
**버전:** v1.0.0

---

## 목차

1. [개요](#1-개요)
2. [엑셀 파일 구조](#2-엑셀-파일-구조)
3. [시트별 상세 명세](#3-시트별-상세-명세)
4. [업로드 절차](#4-업로드-절차)
5. [주의사항](#5-주의사항)
6. [FAQ](#6-faq)

---

## 1. 개요

캘리브레이션/일반 에세이 데이터와 채점 데이터를 엑셀 파일로 한 번에 업로드할 수 있습니다.

### 지원 형식
- `.xlsx` (Excel 2007 이상)
- `.xls` (Excel 97-2003)

### 업로드 가능 데이터
1. **에세이 데이터**: 새 에세이 추가 또는 기존 에세이 업데이트
2. **채점 데이터**: 교사별 채점 점수 (8개 평가요소)

---

## 2. 엑셀 파일 구조

엑셀 파일은 **2개의 시트**로 구성됩니다:

```
mfrm_data_template.xlsx
├── 시트1: essays (에세이 데이터)
└── 시트2: scores (채점 데이터)
```

### 시트 이름 규칙
- 시트 이름은 **정확히** `essays`, `scores`로 지정해야 합니다.
- 대소문자를 구분하지 않습니다 (Essays, ESSAYS 모두 가능)

---

## 3. 시트별 상세 명세

### 3.1 essays 시트 (에세이 데이터)

| 컬럼명 | 필수 | 타입 | 설명 | 예시 |
|--------|------|------|------|------|
| `essay_code` | ✅ | 텍스트 | 에세이 고유 코드 (연결용) | E001, CAL001 |
| `title` | ✅ | 텍스트 | 에세이 제목 | "환경 보호의 중요성" |
| `content` | ✅ | 텍스트 | 에세이 본문 전체 | (긴 텍스트) |
| `grade_level` | ❌ | 텍스트 | 학년 | "고등학교 1학년" |
| `word_count` | ❌ | 숫자 | 어절 수 | 520 |
| `is_anchor` | ❌ | TRUE/FALSE | 앵커 에세이 여부 | FALSE |
| `is_calibration` | ❌ | TRUE/FALSE | 캘리브레이션 세트 여부 | TRUE |
| `difficulty_level` | ❌ | 텍스트 | 난이도 (low/medium/high) | medium |
| `anchor_explanation` | ❌ | 텍스트 | 앵커 해설 (앵커인 경우) | "주장 경계 사례..." |

**예시 데이터:**

| essay_code | title | content | grade_level | word_count | is_anchor | is_calibration | difficulty_level |
|------------|-------|---------|-------------|------------|-----------|----------------|------------------|
| CAL001 | 인공지능의 미래 | 인공지능 기술의 발전은... | 고등학교 2학년 | 580 | FALSE | TRUE | medium |
| CAL002 | 환경과 경제 | 환경 보호와 경제 성장은... | 고등학교 1학년 | 620 | FALSE | TRUE | high |
| GEN001 | 독서의 가치 | 독서는 우리에게... | 중학교 3학년 | 450 | FALSE | FALSE | low |

### 3.2 scores 시트 (채점 데이터)

| 컬럼명 | 필수 | 타입 | 설명 | 예시 |
|--------|------|------|------|------|
| `teacher_email` | ✅ | 텍스트 | 교사 이메일 | teacher1@school.com |
| `essay_code` | ✅ | 텍스트 | 에세이 코드 (essays 시트와 일치) | CAL001 |
| `C1_주장` | ✅ | 1/2/3 | 주장의 명확성과 일관성 | 2 |
| `C2_이유` | ✅ | 1/2/3 | 이유의 타당성과 충분성 | 3 |
| `C3_근거` | ✅ | 1/2/3 | 근거의 질과 양 | 2 |
| `O1_통일성` | ✅ | 1/2/3 | 글의 주제 중심 일관성 | 3 |
| `O2_응집성` | ✅ | 1/2/3 | 문장과 문단 간의 논리적 연결 | 2 |
| `O3_완결성` | ✅ | 1/2/3 | 서론-본론-결론 구조 완성도 | 3 |
| `E1_어휘문장` | ✅ | 1/2/3 | 어휘와 문장의 적절성과 효과성 | 2 |
| `E2_어문규범` | ✅ | 1/2/3 | 맞춤법, 띄어쓰기, 문장부호 준수 | 3 |

**예시 데이터:**

| teacher_email | essay_code | C1_주장 | C2_이유 | C3_근거 | O1_통일성 | O2_응집성 | O3_완결성 | E1_어휘문장 | E2_어문규범 |
|---------------|------------|---------|---------|---------|-----------|-----------|-----------|-------------|-------------|
| teacher1@school.com | CAL001 | 2 | 3 | 2 | 3 | 2 | 3 | 2 | 3 |
| teacher1@school.com | CAL002 | 3 | 3 | 3 | 2 | 3 | 2 | 3 | 2 |
| teacher2@school.com | CAL001 | 2 | 2 | 2 | 3 | 2 | 3 | 2 | 2 |
| teacher2@school.com | CAL002 | 3 | 2 | 3 | 2 | 2 | 2 | 3 | 3 |

### 3.3 평가요소 코드 매핑

| 코드 | 범주 | 평가요소명 | 설명 |
|------|------|-----------|------|
| C1 | 내용 | 주장 | 주장의 명확성과 일관성 |
| C2 | 내용 | 이유 | 이유의 타당성과 충분성 |
| C3 | 내용 | 근거 | 근거의 질과 양 |
| O1 | 조직 | 통일성 | 글의 주제 중심 일관성 |
| O2 | 조직 | 응집성 | 문장과 문단 간의 논리적 연결 |
| O3 | 조직 | 완결성 | 서론-본론-결론의 구조 완성도 |
| E1 | 표현 | 어휘·문장 적절성 | 어휘와 문장의 적절성과 효과성 |
| E2 | 표현 | 어문 규범 준수 | 맞춤법, 띄어쓰기, 문장부호 준수 |

---

## 4. 업로드 절차

### Step 1: 엑셀 파일 준비
1. 템플릿 다운로드 또는 직접 생성
2. `essays` 시트에 에세이 데이터 입력
3. `scores` 시트에 채점 데이터 입력
4. 저장 (.xlsx 형식)

### Step 2: 업로드
1. 관리자 모드 로그인
2. `📦 대량 업로드` 메뉴 클릭
3. 파일 선택 또는 드래그 앤 드롭
4. `미리보기` 버튼으로 데이터 확인

### Step 3: 검증
시스템이 자동으로 다음을 검증합니다:
- 필수 컬럼 존재 여부
- 점수 범위 (1-3)
- essay_code 일치 여부
- teacher_email 유효성

### Step 4: 저장
1. 검증 통과 후 `저장` 버튼 클릭
2. 저장 결과 확인

---

## 5. 주의사항

### 5.1 essay_code 관련
- `essay_code`는 시스템 내에서 에세이를 식별하는 고유 코드입니다.
- scores 시트의 `essay_code`는 essays 시트에 존재해야 합니다.
- 기존 에세이에 점수를 추가하려면 해당 에세이의 `essay_code`를 사용하세요.

### 5.2 교사 관련
- `teacher_email`은 시스템에 등록된 교사여야 합니다.
- 미등록 교사의 경우 자동으로 새 교사로 등록됩니다.

### 5.3 점수 관련
- 점수는 반드시 1, 2, 3 중 하나여야 합니다.
- 빈 셀은 허용되지 않습니다.

### 5.4 기존 데이터 처리
- 같은 essay_code가 이미 존재하면 **업데이트**됩니다.
- 같은 (teacher, essay, rubric) 조합의 점수가 이미 존재하면 **업데이트**됩니다.

### 5.5 대용량 데이터
- 권장 최대: 에세이 500편, 채점 데이터 5,000행
- 그 이상은 파일을 분할하여 업로드하세요.

---

## 6. FAQ

### Q1: 에세이만 업로드하고 싶어요.
A: `scores` 시트를 비워두거나 삭제해도 됩니다. `essays` 시트만 있으면 에세이만 업로드됩니다.

### Q2: 채점 데이터만 추가하고 싶어요.
A: `essays` 시트를 비워두고, `scores` 시트에만 데이터를 입력하세요. 단, essay_code는 기존에 등록된 에세이의 코드여야 합니다.

### Q3: 한 에세이에 여러 교사가 채점한 경우?
A: scores 시트에 각 교사별로 별도 행을 추가하면 됩니다.

### Q4: 엑셀 셀에 줄바꿈이 있어도 되나요?
A: 네, content 등 긴 텍스트 필드에서는 줄바꿈이 지원됩니다.

### Q5: 업로드 후 수정하고 싶어요.
A: 같은 essay_code로 다시 업로드하면 해당 에세이가 업데이트됩니다. 또는 웹 UI에서 개별 수정도 가능합니다.

---

## 부록: 템플릿 다운로드

웹 UI의 `📦 대량 업로드` 페이지에서 빈 템플릿을 다운로드할 수 있습니다.

---

**Last Updated:** 2025-12-17  
**Version:** v1.0.0
