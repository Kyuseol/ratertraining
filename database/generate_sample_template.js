/**
 * ìƒ˜í”Œ ì—‘ì…€ í…œí”Œë¦¿ ìƒì„± ìŠ¤í¬ë¦½íŠ¸
 * 
 * ì‚¬ìš©ë²•: node generate_sample_template.js
 * 
 * ì´ ìŠ¤í¬ë¦½íŠ¸ëŠ” ëŒ€ëŸ‰ ì—…ë¡œë“œì— ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ìƒ˜í”Œ ë°ì´í„°ê°€ í¬í•¨ëœ
 * ì—‘ì…€ í…œí”Œë¦¿ íŒŒì¼ì„ ìƒì„±í•©ë‹ˆë‹¤.
 */

const XLSX = require('xlsx');
const path = require('path');

// ìƒ˜í”Œ ì—ì„¸ì´ ë°ì´í„°
const sampleEssays = [
  {
    essay_code: 'CAL001',
    title: 'ì¸ê³µì§€ëŠ¥ê³¼ ë¯¸ë˜ ì‚¬íšŒ',
    content: `ì¸ê³µì§€ëŠ¥ ê¸°ìˆ ì˜ ë°œì „ì€ ìš°ë¦¬ ì‚¬íšŒì— í° ë³€í™”ë¥¼ ê°€ì ¸ì˜¤ê³  ìˆìŠµë‹ˆë‹¤. ììœ¨ì£¼í–‰ ìë™ì°¨, ì˜ë£Œ ì§„ë‹¨ ì‹œìŠ¤í…œ, ì±—ë´‡ ì„œë¹„ìŠ¤ ë“± ë‹¤ì–‘í•œ ë¶„ì•¼ì—ì„œ AIê°€ í™œìš©ë˜ê³  ìˆìŠµë‹ˆë‹¤.

ì´ëŸ¬í•œ ë³€í™”ëŠ” ê¸ì •ì ì¸ ì¸¡ë©´ê³¼ ë¶€ì •ì ì¸ ì¸¡ë©´ì„ ëª¨ë‘ ê°€ì§€ê³  ìˆìŠµë‹ˆë‹¤. ê¸ì •ì ì¸ ì¸¡ë©´ìœ¼ë¡œëŠ” ì—…ë¬´ íš¨ìœ¨ì„± í–¥ìƒ, ìœ„í—˜í•œ ì‘ì—…ì˜ ìë™í™”, ì˜ë£Œ ì„œë¹„ìŠ¤ ì ‘ê·¼ì„± ê°œì„  ë“±ì´ ìˆìŠµë‹ˆë‹¤. ë°˜ë©´ ì¼ìë¦¬ ê°ì†Œ, ê°œì¸ì •ë³´ ì¹¨í•´ ìš°ë ¤, ê¸°ìˆ  ê²©ì°¨ ì‹¬í™” ë“±ì˜ ë¬¸ì œë„ ì œê¸°ë˜ê³  ìˆìŠµë‹ˆë‹¤.

ë”°ë¼ì„œ ìš°ë¦¬ëŠ” ì¸ê³µì§€ëŠ¥ ê¸°ìˆ ì˜ ë°œì „ì„ ë¬´ì¡°ê±´ í™˜ì˜í•˜ê¸°ë³´ë‹¤ëŠ”, ê·¸ê²ƒì´ ê°€ì ¸ì˜¬ ì‚¬íšŒì  ì˜í–¥ì„ ë©´ë°€íˆ ë¶„ì„í•˜ê³  ì ì ˆí•œ ëŒ€ì‘ì±…ì„ ë§ˆë ¨í•´ì•¼ í•©ë‹ˆë‹¤. ê¸°ìˆ  ë°œì „ê³¼ í•¨ê»˜ ì¸ê°„ì˜ ì¡´ì—„ì„±ê³¼ ì‚¬íšŒì  ê°€ì¹˜ê°€ ë³´ì¡´ë  ìˆ˜ ìˆë„ë¡ ê· í˜• ì¡íŒ ì ‘ê·¼ì´ í•„ìš”í•©ë‹ˆë‹¤.`,
    grade_level: 'ê³ ë“±í•™êµ 2í•™ë…„',
    word_count: 580,
    is_anchor: 'FALSE',
    is_calibration: 'TRUE',
    difficulty_level: 'medium',
    anchor_explanation: '',
  },
  {
    essay_code: 'CAL002',
    title: 'í™˜ê²½ ë³´í˜¸ì™€ ê²½ì œ ë°œì „ì˜ ì¡°í™”',
    content: `í™˜ê²½ ë³´í˜¸ì™€ ê²½ì œ ë°œì „ì€ ìƒì¶©í•˜ëŠ” ëª©í‘œì²˜ëŸ¼ ë³´ì´ì§€ë§Œ, ì‹¤ì œë¡œëŠ” ì§€ì† ê°€ëŠ¥í•œ ë°œì „ì„ ìœ„í•´ ë°˜ë“œì‹œ ì¡°í™”ë¥¼ ì´ë£¨ì–´ì•¼ í•˜ëŠ” ë‘ ê°€ì¹˜ì…ë‹ˆë‹¤.

ë¨¼ì €, í™˜ê²½ ë³´í˜¸ê°€ ì™œ ì¤‘ìš”í•œì§€ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤. ì§€êµ¬ ì˜¨ë‚œí™”, ëŒ€ê¸° ì˜¤ì—¼, ìˆ˜ì§ˆ ì˜¤ì—¼ ë“± í™˜ê²½ ë¬¸ì œëŠ” ì¸ë¥˜ì˜ ìƒì¡´ ìì²´ë¥¼ ìœ„í˜‘í•˜ê³  ìˆìŠµë‹ˆë‹¤. ì´ëŸ¬í•œ ë¬¸ì œë“¤ì„ í•´ê²°í•˜ì§€ ì•Šìœ¼ë©´ ê²½ì œ ë°œì „ ìì²´ê°€ ë¬´ì˜ë¯¸í•´ì§ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

í•œí¸, ê²½ì œ ë°œì „ ì—­ì‹œ ë¬´ì‹œí•  ìˆ˜ ì—†ëŠ” ê°€ì¹˜ì…ë‹ˆë‹¤. ì¼ìë¦¬ ì°½ì¶œ, ìƒí™œ ìˆ˜ì¤€ í–¥ìƒ, ê¸°ìˆ  í˜ì‹  ë“±ì€ ê²½ì œ ë°œì „ì„ í†µí•´ ì´ë£¨ì–´ì§‘ë‹ˆë‹¤. íŠ¹íˆ ê°œë°œë„ìƒêµ­ì˜ ê²½ìš° ë¹ˆê³¤ íƒˆì¶œì„ ìœ„í•´ ê²½ì œ ì„±ì¥ì´ í•„ìˆ˜ì ì…ë‹ˆë‹¤.

ê²°ë¡ ì ìœ¼ë¡œ, ì¹œí™˜ê²½ ê¸°ìˆ  ê°œë°œ, ì¬ìƒ ì—ë„ˆì§€ ì‚°ì—… ìœ¡ì„±, ìˆœí™˜ ê²½ì œ êµ¬ì¶• ë“±ì„ í†µí•´ í™˜ê²½ ë³´í˜¸ì™€ ê²½ì œ ë°œì „ì˜ ì„ ìˆœí™˜ êµ¬ì¡°ë¥¼ ë§Œë“¤ì–´ì•¼ í•©ë‹ˆë‹¤.`,
    grade_level: 'ê³ ë“±í•™êµ 1í•™ë…„',
    word_count: 620,
    is_anchor: 'FALSE',
    is_calibration: 'TRUE',
    difficulty_level: 'high',
    anchor_explanation: '',
  },
  {
    essay_code: 'CAL003',
    title: 'ë…ì„œì˜ ê°€ì¹˜ì™€ ì¤‘ìš”ì„±',
    content: `ë…ì„œëŠ” ì˜¤ë˜ì „ë¶€í„° ì¸ê°„ì˜ ì§€ì‹ê³¼ êµì–‘ì„ ìŒ“ëŠ” ê°€ì¥ ê¸°ë³¸ì ì¸ ë°©ë²•ì´ì—ˆìŠµë‹ˆë‹¤. ë””ì§€í„¸ ì‹œëŒ€ì¸ ì˜¤ëŠ˜ë‚ ì—ë„ ë…ì„œì˜ ê°€ì¹˜ëŠ” ë³€í•¨ì—†ì´ ì¤‘ìš”í•©ë‹ˆë‹¤.

ë…ì„œë¥¼ í†µí•´ ìš°ë¦¬ëŠ” ë‹¤ì–‘í•œ ì§€ì‹ì„ ìŠµë“í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì—­ì‚¬, ê³¼í•™, ì² í•™ ë“± ë‹¤ì–‘í•œ ë¶„ì•¼ì˜ ì±…ì„ ì½ìœ¼ë©´ì„œ ì„¸ìƒì— ëŒ€í•œ ì´í•´ì˜ í­ì„ ë„“í ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ë˜í•œ ë…ì„œëŠ” ì‚¬ê³ ë ¥ê³¼ ì°½ì˜ë ¥ì„ í‚¤ì›Œì¤ë‹ˆë‹¤. ì±…ì„ ì½ìœ¼ë©´ì„œ ë‚´ìš©ì„ ì´í•´í•˜ê³ , ë¶„ì„í•˜ê³ , ë¹„íŒì ìœ¼ë¡œ í‰ê°€í•˜ëŠ” ê³¼ì •ì—ì„œ ìì—°ìŠ¤ëŸ½ê²Œ ì‚¬ê³ ë ¥ì´ í–¥ìƒë©ë‹ˆë‹¤.

ë”°ë¼ì„œ í•™ìƒë“¤ì€ ë¬¼ë¡ ì´ê³  ì„±ì¸ë“¤ë„ ê¾¸ì¤€íˆ ë…ì„œí•˜ëŠ” ìŠµê´€ì„ ê¸°ë¥´ëŠ” ê²ƒì´ ì¢‹ìŠµë‹ˆë‹¤.`,
    grade_level: 'ì¤‘í•™êµ 3í•™ë…„',
    word_count: 450,
    is_anchor: 'FALSE',
    is_calibration: 'TRUE',
    difficulty_level: 'low',
    anchor_explanation: '',
  },
  {
    essay_code: 'GEN001',
    title: 'ì²­ì†Œë…„ ìŠ¤ë§ˆíŠ¸í° ì‚¬ìš©',
    content: `ìš”ì¦˜ ì²­ì†Œë…„ë“¤ì˜ ìŠ¤ë§ˆíŠ¸í° ì‚¬ìš©ì´ í¬ê²Œ ëŠ˜ê³  ìˆìŠµë‹ˆë‹¤. ì´ì— ëŒ€í•´ ì°¬ë°˜ ì˜ê²¬ì´ ë‚˜ë‰˜ê³  ìˆìŠµë‹ˆë‹¤.

ìŠ¤ë§ˆíŠ¸í°ì€ ì •ë³´ ê²€ìƒ‰, í•™ìŠµ, ì†Œí†µ ë“±ì— ìœ ìš©í•˜ê²Œ í™œìš©ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ ê³¼ë„í•œ ì‚¬ìš©ì€ í•™ì—… ë°©í•´, ìˆ˜ë©´ ë¶€ì¡±, ì‚¬ì´ë²„ ë²”ì£„ ë…¸ì¶œ ë“±ì˜ ë¬¸ì œë¥¼ ì¼ìœ¼í‚¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ë”°ë¼ì„œ ì²­ì†Œë…„ë“¤ì˜ ìŠ¤ë§ˆíŠ¸í° ì‚¬ìš©ì— ëŒ€í•œ ì ì ˆí•œ ì§€ë„ê°€ í•„ìš”í•©ë‹ˆë‹¤.`,
    grade_level: 'ì¤‘í•™êµ 2í•™ë…„',
    word_count: 320,
    is_anchor: 'FALSE',
    is_calibration: 'FALSE',
    difficulty_level: 'low',
    anchor_explanation: '',
  },
  {
    essay_code: 'GEN002',
    title: 'í•™êµ ê¸‰ì‹ì˜ ê°œì„  ë°©í–¥',
    content: `í•™êµ ê¸‰ì‹ì€ í•™ìƒë“¤ì˜ ê±´ê°•ê³¼ í•™ìŠµ ëŠ¥ë ¥ì— ì§ì ‘ì ì¸ ì˜í–¥ì„ ë¯¸ì¹˜ëŠ” ì¤‘ìš”í•œ ìš”ì†Œì…ë‹ˆë‹¤. í˜„ì¬ í•™êµ ê¸‰ì‹ì˜ í˜„í™©ì„ ì‚´í´ë³´ê³  ê°œì„  ë°©í–¥ì„ ì œì‹œí•˜ê³ ì í•©ë‹ˆë‹¤.

ì²«ì§¸, ì˜ì–‘ ê· í˜•ì„ ê³ ë ¤í•œ ë©”ë‰´ êµ¬ì„±ì´ í•„ìš”í•©ë‹ˆë‹¤. íƒ„ìˆ˜í™”ë¬¼, ë‹¨ë°±ì§ˆ, ì§€ë°©, ë¹„íƒ€ë¯¼, ë¬´ê¸°ì§ˆ ë“± 5ëŒ€ ì˜ì–‘ì†Œê°€ ê· í˜• ìˆê²Œ í¬í•¨ëœ ì‹ë‹¨ì´ ì œê³µë˜ì–´ì•¼ í•©ë‹ˆë‹¤.

ë‘˜ì§¸, í•™ìƒë“¤ì˜ ê¸°í˜¸ë¥¼ ë°˜ì˜í•œ ë©”ë‰´ ê°œë°œì´ í•„ìš”í•©ë‹ˆë‹¤. ì•„ë¬´ë¦¬ ì˜ì–‘ê°€ ë†’ì€ ìŒì‹ì´ë¼ë„ í•™ìƒë“¤ì´ ë¨¹ì§€ ì•Šìœ¼ë©´ ì˜ë¯¸ê°€ ì—†ìŠµë‹ˆë‹¤.

ì…‹ì§¸, ì‹ì¬ë£Œì˜ ì•ˆì „ì„± í™•ë³´ê°€ ì¤‘ìš”í•©ë‹ˆë‹¤. ì‹ ì„ í•œ ì‹ì¬ë£Œë¥¼ ì‚¬ìš©í•˜ê³  ìœ„ìƒì ì¸ ì¡°ë¦¬ í™˜ê²½ì„ ìœ ì§€í•´ì•¼ í•©ë‹ˆë‹¤.

ì´ëŸ¬í•œ ë…¸ë ¥ì„ í†µí•´ í•™êµ ê¸‰ì‹ì´ í•™ìƒë“¤ì˜ ê±´ê°•í•œ ì„±ì¥ì„ ë•ëŠ” ì—­í• ì„ ì¶©ì‹¤íˆ ìˆ˜í–‰í•  ìˆ˜ ìˆì„ ê²ƒì…ë‹ˆë‹¤.`,
    grade_level: 'ê³ ë“±í•™êµ 1í•™ë…„',
    word_count: 550,
    is_anchor: 'FALSE',
    is_calibration: 'FALSE',
    difficulty_level: 'medium',
    anchor_explanation: '',
  },
];

// ìƒ˜í”Œ ì±„ì  ë°ì´í„°
const sampleScores = [
  // êµì‚¬1ì˜ ì±„ì 
  {
    teacher_email: 'teacher1@example.com',
    essay_code: 'CAL001',
    'C1_ì£¼ì¥': 3, 'C2_ì´ìœ ': 3, 'C3_ê·¼ê±°': 2,
    'O1_í†µì¼ì„±': 3, 'O2_ì‘ì§‘ì„±': 2, 'O3_ì™„ê²°ì„±': 3,
    'E1_ì–´íœ˜ë¬¸ì¥': 2, 'E2_ì–´ë¬¸ê·œë²”': 3,
  },
  {
    teacher_email: 'teacher1@example.com',
    essay_code: 'CAL002',
    'C1_ì£¼ì¥': 3, 'C2_ì´ìœ ': 2, 'C3_ê·¼ê±°': 3,
    'O1_í†µì¼ì„±': 3, 'O2_ì‘ì§‘ì„±': 3, 'O3_ì™„ê²°ì„±': 3,
    'E1_ì–´íœ˜ë¬¸ì¥': 3, 'E2_ì–´ë¬¸ê·œë²”': 2,
  },
  {
    teacher_email: 'teacher1@example.com',
    essay_code: 'CAL003',
    'C1_ì£¼ì¥': 2, 'C2_ì´ìœ ': 2, 'C3_ê·¼ê±°': 2,
    'O1_í†µì¼ì„±': 2, 'O2_ì‘ì§‘ì„±': 2, 'O3_ì™„ê²°ì„±': 2,
    'E1_ì–´íœ˜ë¬¸ì¥': 2, 'E2_ì–´ë¬¸ê·œë²”': 2,
  },
  {
    teacher_email: 'teacher1@example.com',
    essay_code: 'GEN001',
    'C1_ì£¼ì¥': 2, 'C2_ì´ìœ ': 1, 'C3_ê·¼ê±°': 1,
    'O1_í†µì¼ì„±': 2, 'O2_ì‘ì§‘ì„±': 1, 'O3_ì™„ê²°ì„±': 2,
    'E1_ì–´íœ˜ë¬¸ì¥': 2, 'E2_ì–´ë¬¸ê·œë²”': 2,
  },
  {
    teacher_email: 'teacher1@example.com',
    essay_code: 'GEN002',
    'C1_ì£¼ì¥': 3, 'C2_ì´ìœ ': 2, 'C3_ê·¼ê±°': 2,
    'O1_í†µì¼ì„±': 3, 'O2_ì‘ì§‘ì„±': 2, 'O3_ì™„ê²°ì„±': 3,
    'E1_ì–´íœ˜ë¬¸ì¥': 2, 'E2_ì–´ë¬¸ê·œë²”': 3,
  },
  
  // êµì‚¬2ì˜ ì±„ì 
  {
    teacher_email: 'teacher2@example.com',
    essay_code: 'CAL001',
    'C1_ì£¼ì¥': 3, 'C2_ì´ìœ ': 2, 'C3_ê·¼ê±°': 2,
    'O1_í†µì¼ì„±': 3, 'O2_ì‘ì§‘ì„±': 2, 'O3_ì™„ê²°ì„±': 2,
    'E1_ì–´íœ˜ë¬¸ì¥': 2, 'E2_ì–´ë¬¸ê·œë²”': 3,
  },
  {
    teacher_email: 'teacher2@example.com',
    essay_code: 'CAL002',
    'C1_ì£¼ì¥': 3, 'C2_ì´ìœ ': 3, 'C3_ê·¼ê±°': 3,
    'O1_í†µì¼ì„±': 3, 'O2_ì‘ì§‘ì„±': 2, 'O3_ì™„ê²°ì„±': 3,
    'E1_ì–´íœ˜ë¬¸ì¥': 3, 'E2_ì–´ë¬¸ê·œë²”': 3,
  },
  {
    teacher_email: 'teacher2@example.com',
    essay_code: 'CAL003',
    'C1_ì£¼ì¥': 2, 'C2_ì´ìœ ': 2, 'C3_ê·¼ê±°': 1,
    'O1_í†µì¼ì„±': 2, 'O2_ì‘ì§‘ì„±': 2, 'O3_ì™„ê²°ì„±': 2,
    'E1_ì–´íœ˜ë¬¸ì¥': 2, 'E2_ì–´ë¬¸ê·œë²”': 2,
  },
  {
    teacher_email: 'teacher2@example.com',
    essay_code: 'GEN001',
    'C1_ì£¼ì¥': 2, 'C2_ì´ìœ ': 1, 'C3_ê·¼ê±°': 2,
    'O1_í†µì¼ì„±': 2, 'O2_ì‘ì§‘ì„±': 2, 'O3_ì™„ê²°ì„±': 1,
    'E1_ì–´íœ˜ë¬¸ì¥': 2, 'E2_ì–´ë¬¸ê·œë²”': 1,
  },
  {
    teacher_email: 'teacher2@example.com',
    essay_code: 'GEN002',
    'C1_ì£¼ì¥': 2, 'C2_ì´ìœ ': 2, 'C3_ê·¼ê±°': 2,
    'O1_í†µì¼ì„±': 2, 'O2_ì‘ì§‘ì„±': 2, 'O3_ì™„ê²°ì„±': 3,
    'E1_ì–´íœ˜ë¬¸ì¥': 2, 'E2_ì–´ë¬¸ê·œë²”': 2,
  },
  
  // êµì‚¬3ì˜ ì±„ì 
  {
    teacher_email: 'teacher3@example.com',
    essay_code: 'CAL001',
    'C1_ì£¼ì¥': 2, 'C2_ì´ìœ ': 3, 'C3_ê·¼ê±°': 2,
    'O1_í†µì¼ì„±': 2, 'O2_ì‘ì§‘ì„±': 2, 'O3_ì™„ê²°ì„±': 3,
    'E1_ì–´íœ˜ë¬¸ì¥': 3, 'E2_ì–´ë¬¸ê·œë²”': 2,
  },
  {
    teacher_email: 'teacher3@example.com',
    essay_code: 'CAL002',
    'C1_ì£¼ì¥': 3, 'C2_ì´ìœ ': 2, 'C3_ê·¼ê±°': 2,
    'O1_í†µì¼ì„±': 3, 'O2_ì‘ì§‘ì„±': 3, 'O3_ì™„ê²°ì„±': 2,
    'E1_ì–´íœ˜ë¬¸ì¥': 2, 'E2_ì–´ë¬¸ê·œë²”': 3,
  },
  {
    teacher_email: 'teacher3@example.com',
    essay_code: 'CAL003',
    'C1_ì£¼ì¥': 2, 'C2_ì´ìœ ': 1, 'C3_ê·¼ê±°': 2,
    'O1_í†µì¼ì„±': 2, 'O2_ì‘ì§‘ì„±': 1, 'O3_ì™„ê²°ì„±': 2,
    'E1_ì–´íœ˜ë¬¸ì¥': 2, 'E2_ì–´ë¬¸ê·œë²”': 2,
  },
];

// ì—‘ì…€ íŒŒì¼ ìƒì„±
function generateTemplate() {
  const wb = XLSX.utils.book_new();

  // essays ì‹œíŠ¸ ìƒì„±
  const essaysWs = XLSX.utils.json_to_sheet(sampleEssays);
  
  // ì»¬ëŸ¼ ë„ˆë¹„ ì„¤ì •
  essaysWs['!cols'] = [
    { wch: 12 },  // essay_code
    { wch: 30 },  // title
    { wch: 100 }, // content
    { wch: 18 },  // grade_level
    { wch: 12 },  // word_count
    { wch: 10 },  // is_anchor
    { wch: 15 },  // is_calibration
    { wch: 15 },  // difficulty_level
    { wch: 40 },  // anchor_explanation
  ];
  
  XLSX.utils.book_append_sheet(wb, essaysWs, 'essays');

  // scores ì‹œíŠ¸ ìƒì„±
  const scoresWs = XLSX.utils.json_to_sheet(sampleScores);
  
  // ì»¬ëŸ¼ ë„ˆë¹„ ì„¤ì •
  scoresWs['!cols'] = [
    { wch: 25 },  // teacher_email
    { wch: 12 },  // essay_code
    { wch: 10 },  // C1_ì£¼ì¥
    { wch: 10 },  // C2_ì´ìœ 
    { wch: 10 },  // C3_ê·¼ê±°
    { wch: 12 },  // O1_í†µì¼ì„±
    { wch: 12 },  // O2_ì‘ì§‘ì„±
    { wch: 12 },  // O3_ì™„ê²°ì„±
    { wch: 14 },  // E1_ì–´íœ˜ë¬¸ì¥
    { wch: 14 },  // E2_ì–´ë¬¸ê·œë²”
  ];
  
  XLSX.utils.book_append_sheet(wb, scoresWs, 'scores');

  // íŒŒì¼ ì €ì¥
  const outputPath = path.join(__dirname, 'mfrm_sample_data.xlsx');
  XLSX.writeFile(wb, outputPath);
  
  console.log(`âœ… ìƒ˜í”Œ ì—‘ì…€ íŒŒì¼ì´ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤: ${outputPath}`);
  console.log(`   - ì—ì„¸ì´: ${sampleEssays.length}í¸`);
  console.log(`   - ì±„ì  ë°ì´í„°: ${sampleScores.length}í–‰`);
  console.log(`   - êµì‚¬: ${new Set(sampleScores.map(s => s.teacher_email)).size}ëª…`);
}

// ë¹ˆ í…œí”Œë¦¿ ìƒì„±
function generateEmptyTemplate() {
  const wb = XLSX.utils.book_new();

  // essays ì‹œíŠ¸ (í—¤ë”ë§Œ)
  const essayHeaders = [
    'essay_code', 'title', 'content', 'grade_level', 'word_count',
    'is_anchor', 'is_calibration', 'difficulty_level', 'anchor_explanation'
  ];
  const essaysWs = XLSX.utils.aoa_to_sheet([essayHeaders]);
  essaysWs['!cols'] = [
    { wch: 12 }, { wch: 30 }, { wch: 100 }, { wch: 18 }, { wch: 12 },
    { wch: 10 }, { wch: 15 }, { wch: 15 }, { wch: 40 }
  ];
  XLSX.utils.book_append_sheet(wb, essaysWs, 'essays');

  // scores ì‹œíŠ¸ (í—¤ë”ë§Œ)
  const scoreHeaders = [
    'teacher_email', 'essay_code',
    'C1_ì£¼ì¥', 'C2_ì´ìœ ', 'C3_ê·¼ê±°',
    'O1_í†µì¼ì„±', 'O2_ì‘ì§‘ì„±', 'O3_ì™„ê²°ì„±',
    'E1_ì–´íœ˜ë¬¸ì¥', 'E2_ì–´ë¬¸ê·œë²”'
  ];
  const scoresWs = XLSX.utils.aoa_to_sheet([scoreHeaders]);
  scoresWs['!cols'] = [
    { wch: 25 }, { wch: 12 },
    { wch: 10 }, { wch: 10 }, { wch: 10 },
    { wch: 12 }, { wch: 12 }, { wch: 12 },
    { wch: 14 }, { wch: 14 }
  ];
  XLSX.utils.book_append_sheet(wb, scoresWs, 'scores');

  // íŒŒì¼ ì €ì¥
  const outputPath = path.join(__dirname, 'mfrm_empty_template.xlsx');
  XLSX.writeFile(wb, outputPath);
  
  console.log(`âœ… ë¹ˆ í…œí”Œë¦¿ íŒŒì¼ì´ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤: ${outputPath}`);
}

// ì‹¤í–‰
console.log('ğŸ“Š MFRM ëŒ€ëŸ‰ ì—…ë¡œë“œ í…œí”Œë¦¿ ìƒì„± ìŠ¤í¬ë¦½íŠ¸');
console.log('=========================================\n');

generateTemplate();
console.log('');
generateEmptyTemplate();

console.log('\nâœ¨ ì™„ë£Œ!');
